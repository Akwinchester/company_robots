# R4C - Robots for consumers

## Небольшая предыстория.
Давным-давно, в далёкой-далёкой галактике, была компания производящая различных 
роботов. 

Каждый робот(**Robot**) имел определенную модель выраженную двух-символьной 
последовательностью(например R2). Одновременно с этим, модель имела различные 
версии(например D2). Напоминает популярный телефон различных моделей(11,12,13...) и его версии
(X,XS,Pro...). Вне компании роботов чаще всего называли по серийному номеру, объединяя модель и версию(например R2-D2).

Также у компании были покупатели(**Customer**) которые периодически заказывали того или иного робота. 

Когда роботов не было в наличии - заказы покупателей(**Order**) попадали в список ожидания.

---
## Что делает данный код?
Это заготовка для сервиса, который ведет учет произведенных роботов,а также 
выполняет некие операции связанные с этим процессом.

Сервис нацелен на удовлетворение потребностей трёх категорий пользователей:
- Технические специалисты компании. Они будут присылать информацию
- Менеджмент компании. Они будут запрашивать информацию
- Клиенты. Им будут отправляться информация
---

## Что реализовано на данный момент?
### Задача 1
Был реализован  endpoint  для приема данных о новых роботах в формате JSON и сохранения в БД.

Во слое модели была добавлена валидация входных данных на соответствие существующим в системе моделям роботов.

Теперь при отправке данных о новом роботе происходит проверка на соответствие модели и версии робота, указанных в запросе, допустимым значениям в системе.

В случае успешной валидации данные сохраняются в БД.

### Задача 2
Была реализована возможность генерации отчета в формате Excel по статистике производства роботов за последнюю неделю.

Отчет доступен по адресу /robots/generate_report/ и содержит отдельные листы для каждой модели роботов с детализацией по версиям.

Данные для отчета формируются путем запроса и агрегации из БД за указанный период.

### Задача 3
При оформлении заказа на отсутствующего на складе робота теперь корректно создается заказ со статусом "Ожидание" и отсутствующей ссылкой на экземпляр робота.

После этого при создании нового робота через сигнал post_save происходит автоматическая рассылка уведомлений клиентам, ожидающим данную модель и версию.

Таким образом, основной функционал по требованиям задания был реализован.

## Что предстоит реализовать
### Покрыть код тестами:
#### Тесты view

- Использовать классы TestCase или APITestCase из django.test
- Создавать клиента для тестирования запросов (self.client)
- Проверять коды ответов, редиректы, контексты
- Для тестов доступа использовать миксин LoginRequiredMixin

####Тесты сервисов

- Написать отдельные тест-кейсы для каждого сервиса
- Создавать объекты моделей для входных данных
- Вызывать методы сервиса, проверять результаты
- При необходимости mocking зависимостей (например, отправка почты)

#### Тесты целостности

- Написать енд-то-энд сценарии с использованием Selenium
- Или реализовать через Django LiveServerTestCase
- Прогонять сценарии от начала до конца, проверять результаты

### Настроить логирование:
- Информационное логирование
- Логирование ошибок

### Реализовать обработку возможных исключений:
- Исключения при работе со встроенными структурами данных
- Исключения при взаимодействии с БД